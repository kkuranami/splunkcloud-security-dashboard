{
  "dataSources": {
    "ds_tVtx4blD": {
      "type": "ds.search",
      "options": {
        "query": "index=\"_audit\" action=\"login attempt*\"  NOT user=internal*\n| eval date=strftime(_time, \"%Y-%m-%d\") \n| eval result=if(info=\"succeeded\", \"succeeded\", \"failed\") \n| stats count(eval(result=\"failed\")) as failures, count(eval(result=\"succeeded\")) as successes by date",
        "queryParameters": {
          "earliest": "-7d@h",
          "latest": "now"
        }
      },
      "name": "Column chart search"
    },
    "ds_Ev23QsKx": {
      "type": "ds.search",
      "options": {
        "query": "index=\"_audit\" action=\"login attempt locked out user\"\r\n| eval date=strftime(_time, \"%Y-%m-%d\")\r\n| stats count by user, date\r\n| sort date, -count",
        "queryParameters": {
          "earliest": "$global_time.earliest$",
          "latest": "$global_time.latest$"
        }
      },
      "name": "Table search6"
    },
    "ds_5O9zK2W8": {
      "type": "ds.search",
      "options": {
        "query": "index=\"_audit\" action=\"login attempt*\" NOT user=internal*\r\nindex=\"_audit\" action=\"login attempt*\" NOT user=internal*\r\n| eval clientip/src=if(isnull(clientip) OR clientip=\"\", src, clientip)\r\n| iplocation clientip/src\r\n| geostats count by user",
        "queryParameters": {
          "earliest": "$global_time.earliest$",
          "latest": "$global_time.latest$"
        }
      },
      "name": "Cluster map search5"
    },
    "ds_evBkL2xb": {
      "type": "ds.search",
      "options": {
        "query": "index=\"_audit\" action=\"login attempt*\"\r\n| eval result=if(info=\"succeeded\", \"succeeded\", \"failed\")\r\n| stats count(eval(result=\"failed\")) as failures, count(eval(result=\"succeeded\")) as successes by user \r\n| eval total_attempts = successes + failures\r\n| eval failure_rate = round(failures * 100 / total_attempts, 2)\r\n| sort - failure_rate\r\n| table user, failures, successes, total_attempts, failure_rate",
        "queryParameters": {
          "earliest": "$global_time.earliest$",
          "latest": "$global_time.latest$"
        }
      },
      "name": "Table search3"
    },
    "ds_3B6Evr6A": {
      "type": "ds.search",
      "options": {
        "query": "index=\"_audit\" action=\"login attempt*\"  NOT user=internal*\r\n| stats count by user",
        "queryParameters": {
          "earliest": "$global_time.earliest$",
          "latest": "$global_time.latest$"
        }
      },
      "name": "Pie chart search4"
    },
    "ds_k2KYF8Mu": {
      "type": "ds.search",
      "options": {
        "query": "index=\"_audit\" action=\"login attempt*\" NOT user=internal*\n| eval clientip/src=if(isnull(clientip) OR clientip=\"\", src, clientip)\n| table _time, user info clientip/src",
        "queryParameters": {
          "earliest": "$global_time.earliest$",
          "latest": "$global_time.latest$"
        }
      },
      "name": "Table search1"
    }
  },
  "visualizations": {
    "viz_1HxBxslx": {
      "type": "splunk.column",
      "options": {
        "yAxisAbbreviation": "auto",
        "y2AxisAbbreviation": "auto",
        "showRoundedY2AxisLabels": false,
        "legendTruncation": "ellipsisMiddle",
        "showY2MajorGridLines": true,
        "xAxisLabelRotation": 0,
        "xAxisTitleVisibility": "show",
        "yAxisTitleVisibility": "show",
        "y2AxisTitleVisibility": "show",
        "yAxisScale": "linear",
        "showOverlayY2Axis": false,
        "y2AxisScale": "inherit",
        "dataValuesDisplay": "off",
        "stackMode": "stacked",
        "showSplitSeries": false,
        "showIndependentYRanges": false,
        "legendDisplay": "right"
      },
      "dataSources": {
        "primary": "ds_tVtx4blD"
      },
      "title": "時系列ログイン成功/失敗回数【7日間固定】"
    },
    "viz_RX02vujR": {
      "type": "splunk.table",
      "options": {
        "count": 20,
        "dataOverlayMode": "none",
        "drilldown": "none",
        "showRowNumbers": false,
        "showInternalFields": false
      },
      "dataSources": {
        "primary": "ds_Ev23QsKx"
      },
      "title": "ロックアウトされたユーザー一覧"
    },
    "viz_ynd4gKTL": {
      "type": "splunk.map",
      "options": {
        "center": [
          0,
          0
        ],
        "zoom": 1,
        "showBaseLayer": true,
        "layers": [
          {
            "type": "bubble",
            "latitude": "> primary | seriesByName('latitude')",
            "longitude": "> primary | seriesByName('longitude')",
            "bubbleSize": "> primary | frameWithoutSeriesNames('_geo_bounds_east', '_geo_bounds_west', '_geo_bounds_north', '_geo_bounds_south', 'latitude', 'longitude') | frameBySeriesTypes('number')",
            "seriesColors": [
              "#7b56db",
              "#cb2196",
              "#008c80",
              "#9d6300",
              "#f6540b",
              "#ff969e",
              "#99b100",
              "#f4b649",
              "#ae8cff",
              "#8cbcff",
              "#813193",
              "#0051b5",
              "#009ceb",
              "#00cdaf",
              "#00490a",
              "#dd9900",
              "#465d00",
              "#ff677b",
              "#ff6ace",
              "#00689d"
            ]
          }
        ]
      },
      "dataSources": {
        "primary": "ds_5O9zK2W8"
      },
      "title": "ログインを試行したユーザーのIPアドレスソース"
    },
    "viz_nJQa8cqC": {
      "type": "splunk.table",
      "options": {
        "count": 20,
        "dataOverlayMode": "none",
        "drilldown": "none",
        "showRowNumbers": false,
        "showInternalFields": false
      },
      "dataSources": {
        "primary": "ds_evBkL2xb"
      },
      "title": "ログイン失敗率の高いユーザー"
    },
    "viz_brSGT2Dt": {
      "type": "splunk.pie",
      "options": {
        "collapseThreshold": 0.01,
        "value": "> primary | seriesByName('count')",
        "label": "> primary | seriesByName('user')"
      },
      "dataSources": {
        "primary": "ds_3B6Evr6A"
      },
      "title": "ユーザー別ログイン試行回数"
    },
    "viz_5M7qhkMG": {
      "type": "splunk.table",
      "options": {
        "count": 20,
        "dataOverlayMode": "none",
        "drilldown": "none",
        "showRowNumbers": false,
        "showInternalFields": false
      },
      "dataSources": {
        "primary": "ds_k2KYF8Mu"
      },
      "title": "直近のログイン試行イベント"
    }
  },
  "inputs": {
    "input_global_trp": {
      "type": "input.timerange",
      "options": {
        "token": "global_time",
        "defaultValue": "-24h@h,now"
      },
      "title": "グローバル時間範囲"
    }
  },
  "layout": {
    "options": {},
    "globalInputs": [
      "input_global_trp"
    ],
    "tabs": {
      "items": [
        {
          "layoutId": "layout_1",
          "label": "New tab"
        }
      ]
    },
    "layoutDefinitions": {
      "layout_1": {
        "type": "grid",
        "structure": [
          {
            "item": "viz_5M7qhkMG",
            "type": "block",
            "position": {
              "x": 0,
              "y": 0,
              "w": 721,
              "h": 350
            }
          },
          {
            "item": "viz_nJQa8cqC",
            "type": "block",
            "position": {
              "x": 0,
              "y": 350,
              "w": 719,
              "h": 339
            }
          },
          {
            "item": "viz_ynd4gKTL",
            "type": "block",
            "position": {
              "x": 0,
              "y": 689,
              "w": 1440,
              "h": 456
            }
          },
          {
            "item": "viz_RX02vujR",
            "type": "block",
            "position": {
              "x": 0,
              "y": 1145,
              "w": 1440,
              "h": 120
            }
          },
          {
            "item": "viz_brSGT2Dt",
            "type": "block",
            "position": {
              "x": 719,
              "y": 350,
              "w": 721,
              "h": 339
            }
          },
          {
            "item": "viz_1HxBxslx",
            "type": "block",
            "position": {
              "x": 721,
              "y": 0,
              "w": 719,
              "h": 350
            }
          }
        ],
        "options": {
          "width": 1440,
          "height": 960
        }
      }
    }
  },
  "title": "login_dashboard",
  "description": "",
  "defaults": {
    "dataSources": {
      "ds.search": {
        "options": {
          "queryParameters": {
            "latest": "$global_time.latest$",
            "earliest": "$global_time.earliest$"
          }
        }
      }
    }
  }
}